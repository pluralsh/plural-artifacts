{{- if and (eq .Values.provider "google") (eq .Values.type "managed") -}}
apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
kind: GCPManagedControlPlane
metadata:
  name: {{ .Values.cluster.name }}
spec:
  clusterName: {{ .Values.cluster.name }}
  {{ with .Values.cluster.google }}
  project: {{ .project }}
  location: {{ .region }}
  enableAutopilot: {{ .enableAutopilot | default false }}
  enableWorkloadIdentity: {{ .enableWorkloadIdentity }}
  {{ if ne .releaseChannel "unspecified" }}
  releaseChannel: {{ .releaseChannel }}
  {{ end }}
  endpoint:
    host: ""
    port: 0
  {{ end }}
  controlPlaneVersion: {{ .Values.cluster.kubernetesVersion | quote }}
{{- end }}
